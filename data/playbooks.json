[
  {
    "playbookId": "PB-01",
    "title": "Unauthorised SaaS OAuth Application Integration",
    "category": "Cloud Security",
    "severity": "High",
    "scenario": "An employee or attacker grants a third-party application access to a corporate SaaS account using OAuth scopes (e.g., read email, access calendar, read/write files). These applications may exfiltrate data, impersonate users or maintain persistent access without triggering standard credential or MFA alerts.",
    "detection": "CASB, SSPM, SaaS Admin Portals, SIEM, Threat Intelligence Feeds.",
    "mitre": "T1528 (Steal Access Token), T1550.001 (Application Access Token), T1098.003 (External Account).",
    "phases": [
      {
        "phase": "1. Preparation (Pre-Incident Setup)",
        "steps": [
          { "action": "Restrict app consent policies", "detail": "Only allow OAuth consent for pre-approved or verified apps." },
          { "action": "Monitor OAuth activity logs", "detail": "Use SIEM or SaaS security tools to track app authorisations and scopes." },
          { "action": "Educate users", "detail": "About risks of authorising personal or unknown apps in corporate environments." },
          { "action": "Integrate SSPM/CASP tools", "detail": "For visibility into authorised applications and risk scoring." },
          { "action": "Apply conditional access policies", "detail": "To limit app connections from unmanaged devices." }
        ]
      },
      {
        "phase": "2. Detection & Analysis",
        "steps": [
          { "action": "Alert triggered", "detail": "Risky or unapproved OAuth app detected with elevated scopes (e.g., read mail, read drive, send messages)." },
          { "action": "Identify user and application", "detail": "Who authorised it, what scopes were granted and what app was used." },
          { "action": "Analyse access logs", "detail": "Check if app accessed sensitive data or performed actions (e.g., sending emails, downloading files)." },
          { "action": "Review app metadata", "detail": "Reputation, risk score, domain registration, previous threat reports." }
        ]
      },
      {
        "phase": "3. Containment",
        "steps": [
          { "action": "Revoke app access immediately", "detail": "Via admin portal (e.g., Azure AD, Google Workspace, Slack admin)." },
          { "action": "Suspend impacted user account", "detail": "If malicious behaviour or data leakage is confirmed." },
          { "action": "Block app domain or API endpoints", "detail": "Via firewall, CASB or DNS filter to prevent callback connections." },
          { "action": "Notify user and security team", "detail": "Initiate internal investigation and containment measures." }
        ]
      },
      {
        "phase": "4. Eradication",
        "steps": [
          { "action": "Remove residual access tokens", "detail": "Revoke all tokens granted to the app and refresh user sessions." },
          { "action": "Rotate credentials and MFA", "detail": "If impersonation or token theft is suspected." },
          { "action": "Conduct full data access review", "detail": "Determine what the app had access to and if data was exfiltrated." },
          { "action": "Update OAuth policy", "detail": "Add the app to a blocklist or blacklist category in SSPM or CASB." }
        ]
      },
      {
        "phase": "5. Recovery",
        "steps": [
          { "action": "Reinstate user access with monitoring", "detail": "Ensure user awareness and endpoint clean-up if malware is linked." },
          { "action": "Apply stricter app review process", "detail": "Require internal approval for all new app integrations." },
          { "action": "Monitor for recurrence", "detail": "Create detections for similar app authorisation patterns or behaviours." },
          { "action": "Validate SaaS logs and alerts", "detail": "Ensure full visibility of high-risk OAuth events." }
        ]
      },
      {
        "phase": "6. Lessons Learned & Reporting",
        "steps": [
          { "action": "Complete root cause analysis", "detail": "Why was the app authorised? Was it phishing, ignorance or bypassed control?" },
          { "action": "Improve user training", "detail": "On secure SaaS usage and application access warnings." },
          { "action": "Strengthen OAuth governance", "detail": "Integrate SSPM and automate risk-based app approval/revocation." },
          { "action": "Document the incident", "detail": "For compliance, audit trails and policy updates." },
          { "action": "Notify affected parties or regulators", "detail": "If customer data or sensitive records were accessed." }
        ]
      }
    ]
  },
  {
    "playbookId": "PB-02",
    "title": "CI/CD Supply Chain Poisoning via Compromised Base Images",
    "category": "DevSecOps",
    "severity": "Critical",
    "scenario": "A developer or CI/CD system pulls a malicious or backdoored container base image (e.g., from Docker Hub, GitHub Packages, public artifact repositories) into a pipeline. This tainted image may contain cryptominers, reverse shells or logic bombs that affect build environments or production deployments.",
    "detection": "CI/CD Logs, Artifact Scanners, CSPM, EDR, Threat Intelligence, Image Scanners (e.g., Trivy, Grype).",
    "mitre": "T1195.002 (Compromise Software Supply Chain), T1204.003 (Malicious File), T1105 (Ingress Tool Transfer).",
    "phases": [
      {
        "phase": "1. Preparation (Pre-Incident Setup)",
        "steps": [
          { "action": "Use trusted internal image registries", "detail": "Prevent use of unknown or unauthorised public images." },
          { "action": "Scan all base images automatically", "detail": "Use tools like Trivy, Grype, Aqua or Clair in CI pipelines." },
          { "action": "Maintain SBOM for all builds", "detail": "Link image layers to dependency origins for traceability." },
          { "action": "Sign and verify container images", "detail": "Use Cosign, Notary v2 or Sigstore for image integrity verification." },
          { "action": "Apply egress restrictions on runners", "detail": "Prevent containers from initiating outbound connections by default." }
        ]
      },
      {
        "phase": "2. Detection & Analysis",
        "steps": [
          { "action": "Alert triggered", "detail": "CI pipeline or image scanner detects malicious binary, network beaconing or unexpected process in base image." },
          { "action": "Identify affected pipelines or builds", "detail": "Trace which projects, services or environments used the image." },
          { "action": "Analyse behaviour of container", "detail": "Review runtime logs, network connections, system modifications." },
          { "action": "Cross-reference with threat intel", "detail": "Check for known IOCs, CVEs or reported backdoored images." }
        ]
      },
      {
        "phase": "3. Containment",
        "steps": [
          { "action": "Block further pulls of the compromised image", "detail": "Remove access from all pipelines and registries." },
          { "action": "Disable affected pipelines or environments", "detail": "Temporarily stop build and deploy operations for impacted apps." },
          { "action": "Revoke image caching", "detail": "Remove local copies of tainted images from runners and registries." },
          { "action": "Notify DevOps, Security and App Owners", "detail": "Coordinate immediate response actions." }
        ]
      },
      {
        "phase": "4. Eradication",
        "steps": [
          { "action": "Replace image with a trusted base", "detail": "Rebuild services using a verified clean base image." },
          { "action": "Remove backdoors or injected tools", "detail": "If deployed into test/staging/production, scan and clean infected containers." },
          { "action": "Update pipeline definitions", "detail": "Reference only signed and vetted base images going forward." },
          { "action": "Rotate secrets and tokens", "detail": "If compromised image had access to environment variables, keys or APIs." }
        ]
      },
      {
        "phase": "5. Recovery",
        "steps": [
          { "action": "Resume clean builds and deploys", "detail": "After validation of base image security and CI/CD pipeline integrity." },
          { "action": "Validate systems that used the image", "detail": "Ensure no persistence mechanisms or lateral movement occurred." },
          { "action": "Monitor for callback traffic", "detail": "From prior deployments using the malicious image." },
          { "action": "Restore from clean backups", "detail": "If persistent changes or damage was detected." }
        ]
      },
      {
        "phase": "6. Lessons Learned & Reporting",
        "steps": [
          { "action": "Conduct RCA", "detail": "Where was the malicious image introduced? How was it authorised?" },
          { "action": "Improve CI/CD governance", "detail": "Enforce image signing, SBOM validation and approval workflows." },
          { "action": "Train development teams", "detail": "On image provenance, trust boundaries and secure Dockerfile practices." },
          { "action": "Document incident", "detail": "Include timelines, IOCs and preventive controls taken." },
          { "action": "Notify stakeholders or regulators", "detail": "If breach involves sensitive data or production services." }
        ]
      }
    ]
  },
  {
    "playbookId": "PB-03",
    "title": "Privilege Escalation via Misconfigured Cloud IAM Roles",
    "category": "Cloud Security",
    "severity": "Critical",
    "scenario": "An attacker (external or insider) identifies and exploits misconfigured IAM roles, policies or trust relationships in cloud platforms (e.g., AWS, Azure, GCP) to escalate privileges. This can include lateral movement from a low-privilege identity to admin or service account roles, enabling full control over cloud resources.",
    "detection": "CSPM, SIEM, Cloud Logs (e.g., CloudTrail, Azure Activity Logs), Identity Analytics, EDR/XDR.",
    "mitre": "T1078.004 (Cloud Accounts), T1484.002 (Domain Trust Abuse), T1550.002 (Use of Cloud Instance Metadata API).",
    "phases": [
      {
        "phase": "1. Preparation (Pre-Incident Setup)",
        "steps": [
          { "action": "Enforce least privilege across IAM", "detail": "Avoid wildcard * permissions, unused role chaining and overly permissive trust policies." },
          { "action": "Enable identity logging", "detail": "Capture all role assumption events, token usage and privilege escalations." },
          { "action": "Use CSPM and IAM analyzers", "detail": "Continuously scan for excessive permissions, unused roles or risky privilege paths." },
          { "action": "Segment high-privilege roles", "detail": "Prevent broad access from service accounts or low-trust identities." },
          { "action": "Apply multi-factor authentication", "detail": "To all privileged user accounts." }
        ]
      },
      {
        "phase": "2. Detection & Analysis",
        "steps": [
          { "action": "Alert triggered", "detail": "Suspicious use of AssumeRole, token escalation or sudden privilege increase." },
          { "action": "Identify the source user or process", "detail": "Determine the original identity and method used (CLI, API, web console)." },
          { "action": "Trace the escalation path", "detail": "Map the IAM policy or trust chain that allowed the privilege elevation." },
          { "action": "Correlate with resource activity", "detail": "Look for high-privilege actions post-escalation (e.g., key export, instance creation)." }
        ]
      },
      {
        "phase": "3. Containment",
        "steps": [
          { "action": "Disable affected IAM roles or policies", "detail": "Immediately remove or update misconfigured trust relationships." },
          { "action": "Revoke temporary credentials", "detail": "Invalidate session tokens or access keys that were abused." },
          { "action": "Limit service account access", "detail": "If automation or machine identity was used for escalation." },
          { "action": "Notify cloud admin and security team", "detail": "Coordinate rapid containment and remediation." }
        ]
      },
      {
        "phase": "4. Eradication",
        "steps": [
          { "action": "Audit and fix IAM misconfigurations", "detail": "Remove over-permissive or unused roles and tighten trust policies." },
          { "action": "Rotate all potentially exposed credentials", "detail": "Especially for accounts with escalation access." },
          { "action": "Validate cloud infrastructure integrity", "detail": "Look for signs of tampering, persistence or lateral movement." },
          { "action": "Review identity federation settings", "detail": "Ensure external IDPs or linked identities follow least privilege." }
        ]
      },
      {
        "phase": "5. Recovery",
        "steps": [
          { "action": "Restore normal IAM role mappings", "detail": "After fixing misconfigurations and confirming safe usage." },
          { "action": "Re-enable workflows and automation", "detail": "With updated permission boundaries and monitoring rules." },
          { "action": "Monitor activity of affected identities", "detail": "Apply anomaly detection for the next 30 days." },
          { "action": "Apply tagging for sensitive roles", "detail": "To enforce stricter review and approval processes." }
        ]
      },
      {
        "phase": "6. Lessons Learned & Reporting",
        "steps": [
          { "action": "Conduct RCA", "detail": "Determine how the escalation path was missed during design or review." },
          { "action": "Improve IAM review processes", "detail": "Regular audits, change approvals and detection rules." },
          { "action": "Train cloud teams", "detail": "On identity-based attack chains and permission boundaries." },
          { "action": "Update IAM policy templates", "detail": "Enforce secure defaults and review workflows in Infrastructure-as-Code." },
          { "action": "Report incident", "detail": "If it led to data exposure or regulatory risk (e.g., PDPA, ISO 27001)." }
        ]
      }
    ]
  },
  {
    "playbookId": "PB-04",
    "title": "Third-Party Vendor Compromise",
    "category": "Supply Chain",
    "severity": "Critical",
    "scenario": "A security breach or malware infection occurs within a third-party vendor's environment that has direct or indirect access to the organisation's systems (e.g., via VPN, API, shared cloud environment, email communication or integration platform). The attacker may leverage this trust relationship to move laterally, steal data or deliver malicious payloads.",
    "detection": "SIEM, Threat Intel Feeds, EDR, Identity Logs, Email Security, External Disclosure (e.g., vendor notification).",
    "mitre": "T1195.002 (Compromise Software Supply Chain), T1133 (External Remote Services), T1203 (Exploitation of Remote Services).",
    "phases": [
      {
        "phase": "1. Preparation (Pre-Incident Setup)",
        "steps": [
          { "action": "Maintain third-party risk registry", "detail": "Identify and rank vendors by access level and criticality." },
          { "action": "Use network segmentation and Zero Trust", "detail": "Minimise vendor access scope." },
          { "action": "Monitor vendor accounts and integration logs", "detail": "Include API usage, VPN activity, email metadata and file sharing logs." },
          { "action": "Enforce strict onboarding and offboarding", "detail": "Review access regularly and revoke unused integrations or accounts." },
          { "action": "Establish incident response SLAs", "detail": "Include third-party reporting requirements in contracts." }
        ]
      },
      {
        "phase": "2. Detection & Analysis",
        "steps": [
          { "action": "Alert triggered", "detail": "Suspicious activity tied to vendor-controlled assets (e.g., VPN session, API call, email with malware)." },
          { "action": "Verify vendor access channels", "detail": "Identify methods of access (VPN, API, SSH, SaaS integration) and their current usage." },
          { "action": "Correlate with internal indicators", "detail": "Determine if lateral movement or data access occurred through the vendor's access." },
          { "action": "Engage with vendor SOC or security team", "detail": "Confirm breach details, timeline, IOCs and scope." }
        ]
      },
      {
        "phase": "3. Containment",
        "steps": [
          { "action": "Disable vendor access temporarily", "detail": "VPN, API keys, user accounts, shared drives or federated identity." },
          { "action": "Block suspicious IPs or tokens", "detail": "If access originated from known malicious infrastructure." },
          { "action": "Isolate any impacted internal systems", "detail": "That were accessed or touched via vendor communication." },
          { "action": "Preserve and collect logs", "detail": "Related to vendor access and internal system interaction." }
        ]
      },
      {
        "phase": "4. Eradication",
        "steps": [
          { "action": "Remove any malware or rogue code", "detail": "Delivered through compromised vendor access or email." },
          { "action": "Rotate credentials used by the vendor", "detail": "API keys, shared passwords, certificates or OAuth tokens." },
          { "action": "Patch exposed services or integrations", "detail": "That may have been used for lateral access." },
          { "action": "Invalidate existing sessions", "detail": "Related to the vendor's access." }
        ]
      },
      {
        "phase": "5. Recovery",
        "steps": [
          { "action": "Re-enable vendor access (if safe)", "detail": "Only after vendor confirms full containment on their side." },
          { "action": "Apply enhanced monitoring", "detail": "For high-risk vendor accounts for at least 30 days." },
          { "action": "Validate integrity of impacted systems", "detail": "Check for configuration changes or backdoors." },
          { "action": "Resume operations", "detail": "After full internal and vendor clearance." }
        ]
      },
      {
        "phase": "6. Lessons Learned & Reporting",
        "steps": [
          { "action": "Conduct RCA", "detail": "Understand entry point, detection delay and lateral movement path." },
          { "action": "Reassess vendor risk and trust level", "detail": "Update risk registry and access privileges accordingly." },
          { "action": "Update contractual security clauses", "detail": "If SLA, breach notification or audit rights were insufficient." },
          { "action": "Share IOCs and findings", "detail": "Internally and with threat intel platforms if necessary." },
          { "action": "Report to regulators or clients", "detail": "If customer data or systems were impacted." }
        ]
      }
    ]
  },
  {
    "playbookId": "PB-05",
    "title": "API Abuse by Compromised Automation Scripts",
    "category": "DevSecOps",
    "severity": "Critical",
    "scenario": "An attacker gains access to API keys or tokens used in automation scripts, build pipelines or cloud jobs. These secrets may be embedded in code, environment variables or CI/CD configuration files and can be exploited to perform unauthorised actions through APIs (e.g., data access, deletion, privilege abuse).",
    "detection": "SIEM, Cloud Logs, WAF, API Gateway Logs, CI/CD Logs, Secret Scanners.",
    "mitre": "T1528 (Steal Access Token), T1110.003 (Brute Force: Password Spraying), T1552.001 (Credentials in Files).",
    "phases": [
      {
        "phase": "1. Preparation (Pre-Incident Setup)",
        "steps": [
          { "action": "Store secrets securely", "detail": "Use vaults (e.g., HashiCorp Vault, AWS Secrets Manager) instead of hardcoding." },
          { "action": "Rotate API tokens regularly", "detail": "Enforce TTLs for short-lived tokens and automate rotation." },
          { "action": "Monitor API usage per key", "detail": "Implement granular logging and usage monitoring for each token." },
          { "action": "Scan repositories and pipelines", "detail": "Use tools like TruffleHog, Gitleaks, GitGuardian to detect exposed secrets." },
          { "action": "Apply rate limits and scope restrictions", "detail": "Minimise token abuse impact by scoping API keys to specific actions." }
        ]
      },
      {
        "phase": "2. Detection & Analysis",
        "steps": [
          { "action": "Alert triggered", "detail": "Abnormal API call pattern, burst traffic, data deletion or external access from automation token." },
          { "action": "Identify token and script source", "detail": "Trace which job, service or script the compromised API key belongs to." },
          { "action": "Review recent script changes", "detail": "Look for unauthorised modifications, token theft or external syncs." },
          { "action": "Correlate with access logs", "detail": "Determine what data or systems were accessed or modified using the token." }
        ]
      },
      {
        "phase": "3. Containment",
        "steps": [
          { "action": "Immediately revoke the compromised API key", "detail": "At the platform or application level." },
          { "action": "Disable the affected script or job", "detail": "To prevent further use until secured." },
          { "action": "Block attacker IPs or sessions", "detail": "If abuse came from external networks." },
          { "action": "Isolate affected service account", "detail": "And audit all associated activities and permissions." }
        ]
      },
      {
        "phase": "4. Eradication",
        "steps": [
          { "action": "Replace compromised tokens", "detail": "Generate new tokens and store them securely in a vault." },
          { "action": "Clean exposed secrets from codebase", "detail": "Purge commits with secrets from Git history (e.g., using BFG or git filter-branch)." },
          { "action": "Strengthen CI/CD secrets handling", "detail": "Enforce secret injection via secure variables instead of plaintext." },
          { "action": "Patch any exploited systems or APIs", "detail": "If abuse exploited a logic flaw or misconfiguration." }
        ]
      },
      {
        "phase": "5. Recovery",
        "steps": [
          { "action": "Resume secure automation jobs", "detail": "After validation and secret reconfiguration." },
          { "action": "Monitor post-incident API usage", "detail": "Track token replacements for abnormal behaviour." },
          { "action": "Verify system state and data integrity", "detail": "Check for unauthorised changes or corruptions due to API abuse." },
          { "action": "Validate all tokens and credentials", "detail": "In the affected namespace, repository or environment." }
        ]
      },
      {
        "phase": "6. Lessons Learned & Reporting",
        "steps": [
          { "action": "Conduct RCA", "detail": "How was the token exposed? What changes are needed in DevOps practices?" },
          { "action": "Update secure coding policies", "detail": "Include rules on secret storage, access scopes and Git hygiene." },
          { "action": "Train developers and DevOps", "detail": "On secure secret handling and pipeline hardening." },
          { "action": "Update API abuse detection rules", "detail": "In SIEM, WAF and API gateways." },
          { "action": "Notify stakeholders or clients", "detail": "If the abuse led to data exfiltration or business impact." }
        ]
      }
    ]
  }
]